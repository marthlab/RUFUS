Bootstrap: library
From: ubuntu:22.04

%labels
    Author Stephanie Georges
    Version v0.0.1

%post
    apt-get update
    apt-get install -y git cmake wget g++ build-essential software-properties-common zlib1g-dev libbz2-dev liblzma-dev bc libncurses5-dev samtools bamtools
    add-apt-repository ppa:ubuntu-toolchain-r/test

    cd /opt

    git clone https://github.com/stefinfection/RUFUS.git
    cd RUFUS
    git checkout singularity_builder
    mkdir bin
    cd bin
    cmake ../
    make

    apt-get purge -y --auto-remove git wget

%environment
    export PATH=$PATH:/opt/RUFUS/bin

%test
    samtools || true
    bamtools || true
    cp -r /opt/RUFUS/testRun/* /mnt
    cd /mnt
    bash /mnt/runTest.sh
    echo "Test ran successfully"

%runscript
    echo "Arguments provided: $*"
    bash /opt/RUFUS/runRufus.sh "$@"
